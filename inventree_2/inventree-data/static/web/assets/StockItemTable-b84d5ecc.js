import{r as m,i as e,j as t,h as a,G as x}from"./vendor-580d7f6a.js";import{A as k}from"./AddItemButton-9bde5586.js";import{P as j,D as g,e as z,S,r as _,g as y}from"./ColumnRenderers-c7f5177c.js";import{a as T,A as b,M as p,U as F,i as v}from"./index-539d0685.js";import{a as C}from"./StockForms-2847fb41.js";import{g as h}from"./urls-9eea01e5.js";import{a as D}from"./UseForm-5e9a21d6.js";import{u as I,I as A,S as P}from"./InvenTreeTable-7dffc519.js";import{u as U}from"./DesktopAppView-f36ad07f.js";function w(){return[{accessor:"part",sortable:!0,render:i=>j(i==null?void 0:i.part_detail)},g({accessor:"part_detail.description"}),{accessor:"quantity",ordering:"stock",sortable:!0,title:e._({id:"blbbPS"}),render:i=>{let l=(i==null?void 0:i.quantity)??0,o=(i==null?void 0:i.allocated)??0,r=l-o,d=l,c=(i==null?void 0:i.part_detail)??{},s=[],n;return i.serial&&l==1&&(d=`# ${i.serial}`),i.is_building&&(n="blue",s.push(t.jsx(a,{size:"sm",children:e._({id:"fh2Vf5"})},"production"))),i.sales_order&&s.push(t.jsx(a,{size:"sm",children:e._({id:"X1BIR/"})},"sales-order")),i.customer&&s.push(t.jsx(a,{size:"sm",children:e._({id:"fHlvYo"})},"customer")),i.belongs_to&&s.push(t.jsx(a,{size:"sm",children:e._({id:"bGwMIh"})},"belongs-to")),i.consumed_by&&s.push(t.jsx(a,{size:"sm",children:e._({id:"Xig/cj"})},"consumed-by")),i.expired?s.push(t.jsx(a,{size:"sm",children:e._({id:"x/QIhZ"})},"expired")):i.stale&&s.push(t.jsx(a,{size:"sm",children:e._({id:"UtuqjX"})},"stale")),o>0&&(o>=l?(n="orange",s.push(t.jsx(a,{size:"sm",children:e._({id:"L1D5PL"})},"fully-allocated"))):s.push(t.jsx(a,{size:"sm",children:e._({id:"PjVOCj"})},"partially-allocated"))),r!=l&&(r>0?s.push(t.jsx(a,{size:"sm",color:"orange",children:e._({id:"csDS2L"})+`: ${r}`},"available")):s.push(t.jsx(a,{size:"sm",color:"red",children:e._({id:"a5n/wL"})},"no-stock"))),l<=0&&(n="red",s.push(t.jsx(a,{size:"sm",children:e._({id:"ddPzUj"})},"depleted"))),t.jsx(z,{value:t.jsxs(x,{spacing:"xs",position:"left",noWrap:!0,children:[t.jsx(a,{color:n,children:d}),c.units&&t.jsxs(a,{size:"xs",color:n,children:["[",c.units,"]"]})]}),title:e._({id:"odasNw"}),extra:s})}},S(p.stockitem),{accessor:"batch",sortable:!0},{accessor:"location",sortable:!0,render:function(i){var l;return((l=i==null?void 0:i.location_detail)==null?void 0:l.pathstring)??i.location??"-"}},{accessor:"expiry_date",sortable:!0,switchable:!0,render:i=>_(i.expiry_date)},{accessor:"updated",sortable:!0,switchable:!0,render:i=>_(i.updated)},{accessor:"purchase_price",sortable:!0,switchable:!0,render:i=>y(i.purchase_price,{currency:i.purchase_price_currency})}]}function E(){return[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"UjHL/d"})},{name:"status",label:e._({id:"uAQUqI"}),description:e._({id:"+Jr1e4"}),choiceFunction:P(p.stockitem)},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"iG2HTd"})},{name:"allocated",label:e._({id:"A/ybx7"}),description:e._({id:"pxiNcZ"})},{name:"available",label:e._({id:"csDS2L"}),description:e._({id:"kbUAFH"})},{name:"cascade",label:e._({id:"VY386J"}),description:e._({id:"fMbOmV"})},{name:"depleted",label:e._({id:"9/P0N3"}),description:e._({id:"0n9TfP"})},{name:"in_stock",label:e._({id:"zn38D/"}),description:e._({id:"oXdFGe"})},{name:"is_building",label:e._({id:"BE5Q6v"}),description:e._({id:"c64azd"})},{name:"include_variants",label:e._({id:"/g9i/Z"}),description:e._({id:"n9gDGi"})},{name:"installed",label:e._({id:"eQkgKV"}),description:e._({id:"GQ73kf"})},{name:"sent_to_customer",label:e._({id:"XwjZor"}),description:e._({id:"LPuYfz"})},{name:"serialized",label:e._({id:"SkCY/+"}),description:e._({id:"S5yS1f"})},{name:"has_batch",label:e._({id:"qPCbMt"}),description:e._({id:"rc/Y1E"})},{name:"tracked",label:e._({id:"EaG6cP"}),description:e._({id:"TRFyJq"})},{name:"has_purchase_price",label:e._({id:"+MprDT"}),description:e._({id:"tAFrkr"})},{name:"external",label:e._({id:"k7rbV9"}),description:e._({id:"ETtRZU"})}]}function J({params:i={}}){let l=m.useMemo(()=>w(),[]),o=m.useMemo(()=>E(),[]);const r=I("stockitems"),d=T(),c=U(),s=C({create:!0}),n=D({url:b.stock_item_list,title:e._({id:"bJLEQT"}),fields:s,initialData:{part:i.part,location:i.location},onFormSuccess:u=>{u.pk&&c(h(p.stockitem,u.pk))}}),f=m.useMemo(()=>[t.jsx(k,{hidden:!d.hasAddRole(F.stock),tooltip:e._({id:"bJLEQT"}),onClick:()=>n.open()})],[d]);return t.jsxs(t.Fragment,{children:[n.modal,t.jsx(A,{url:v(b.stock_item_list),tableState:r,columns:l,props:{enableDownload:!0,enableSelection:!1,tableFilters:o,tableActions:f,onRowClick:u=>c(h(p.stockitem,u.pk)),params:{...i,part_detail:!0,location_detail:!0,supplier_part_detail:!0}}})]})}export{J as S};
