import{ce as J,cf as Q,cg as Qe,ch as Xe,ci as f,r as u,R as z,cj as Zr,ck as er,aO as He,cl as qr,Z as jr,_ as Jr,aN as Qr,cm as Xr,B as Ar,m as et,t as rt,aq as tt,cn as nt,j as p,G as We,h as Ge,co as ot,bD as at,cp as it,cq as st,cr as ct,cs as lt,ct as ut,i as D,ag as rr,$ as tr,bE as nr,bN as ft,S as pt,y as dt,n as or}from"./vendor-580d7f6a.js";import{i as mt,g as ar}from"./index-539d0685.js";import{o as gt,a as vt,b as bt}from"./ApiForm-173d0ec5.js";import{u as yt,R as Dt,a as ht,I as _t}from"./InvenTreeTable-7dffc519.js";var Ot=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ie(e,r){var t=wt(e);if(typeof t.path!="string"){var n=e.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof r=="string"?r:typeof n=="string"&&n.length>0?n:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function wt(e){var r=e.name,t=r&&r.lastIndexOf(".")!==-1;if(t&&!e.type){var n=r.split(".").pop().toLowerCase(),o=Ot.get(n);o&&Object.defineProperty(e,"type",{value:o,writable:!1,configurable:!1,enumerable:!0})}return e}var Et=[".DS_Store","Thumbs.db"];function xt(e){return J(this,void 0,void 0,function(){return Q(this,function(r){return _e(e)&&jt(e.dataTransfer)?[2,St(e.dataTransfer,e.type)]:At(e)?[2,Ft(e)]:Array.isArray(e)&&e.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,Pt(e)]:[2,[]]})})}function jt(e){return _e(e)}function At(e){return _e(e)&&_e(e.target)}function _e(e){return typeof e=="object"&&e!==null}function Ft(e){return Le(e.target.files).map(function(r){return ie(r)})}function Pt(e){return J(this,void 0,void 0,function(){var r;return Q(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(n){return n.getFile()}))];case 1:return r=t.sent(),[2,r.map(function(n){return ie(n)})]}})})}function St(e,r){return J(this,void 0,void 0,function(){var t,n;return Q(this,function(o){switch(o.label){case 0:return e.items?(t=Le(e.items).filter(function(i){return i.kind==="file"}),r!=="drop"?[2,t]:[4,Promise.all(t.map(Ct))]):[3,2];case 1:return n=o.sent(),[2,ir(Fr(n))];case 2:return[2,ir(Le(e.files).map(function(i){return ie(i)}))]}})})}function ir(e){return e.filter(function(r){return Et.indexOf(r.name)===-1})}function Le(e){if(e===null)return[];for(var r=[],t=0;t<e.length;t++){var n=e[t];r.push(n)}return r}function Ct(e){if(typeof e.webkitGetAsEntry!="function")return sr(e);var r=e.webkitGetAsEntry();return r&&r.isDirectory?Pr(r):sr(e)}function Fr(e){return e.reduce(function(r,t){return Qe(Qe([],Xe(r),!1),Xe(Array.isArray(t)?Fr(t):[t]),!1)},[])}function sr(e){var r=e.getAsFile();if(!r)return Promise.reject("".concat(e," is not a File"));var t=ie(r);return Promise.resolve(t)}function kt(e){return J(this,void 0,void 0,function(){return Q(this,function(r){return[2,e.isDirectory?Pr(e):zt(e)]})})}function Pr(e){var r=e.createReader();return new Promise(function(t,n){var o=[];function i(){var l=this;r.readEntries(function(c){return J(l,void 0,void 0,function(){var d,h,w;return Q(this,function(b){switch(b.label){case 0:if(c.length)return[3,5];b.label=1;case 1:return b.trys.push([1,3,,4]),[4,Promise.all(o)];case 2:return d=b.sent(),t(d),[3,4];case 3:return h=b.sent(),n(h),[3,4];case 4:return[3,6];case 5:w=Promise.all(c.map(kt)),o.push(w),i(),b.label=6;case 6:return[2]}})})},function(c){n(c)})}i()})}function zt(e){return J(this,void 0,void 0,function(){return Q(this,function(r){return[2,new Promise(function(t,n){e.file(function(o){var i=ie(o,e.fullPath);t(i)},function(o){n(o)})})]})})}var It=function(e,r){if(e&&r){var t=Array.isArray(r)?r:r.split(","),n=e.name||"",o=(e.type||"").toLowerCase(),i=o.replace(/\/.*$/,"");return t.some(function(l){var c=l.trim().toLowerCase();return c.charAt(0)==="."?n.toLowerCase().endsWith(c):c.endsWith("/*")?i===c.replace(/\/.*$/,""):o===c})}return!0};function cr(e){return $t(e)||Rt(e)||Cr(e)||Tt()}function Tt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $t(e){if(Array.isArray(e))return Me(e)}function lr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,n)}return t}function ur(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lr(Object(t),!0).forEach(function(n){Sr(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Sr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ae(e,r){return Nt(e)||Mt(e,r)||Cr(e,r)||Lt()}function Lt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cr(e,r){if(e){if(typeof e=="string")return Me(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Me(e,r)}}function Me(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Mt(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],o=!0,i=!1,l,c;try{for(t=t.call(e);!(o=(l=t.next()).done)&&(n.push(l.value),!(r&&n.length===r));o=!0);}catch(d){i=!0,c=d}finally{try{!o&&t.return!=null&&t.return()}finally{if(i)throw c}}return n}}function Nt(e){if(Array.isArray(e))return e}var Kt="file-invalid-type",Bt="file-too-large",Ht="file-too-small",Wt="too-many-files",Gt=function(r){r=Array.isArray(r)&&r.length===1?r[0]:r;var t=Array.isArray(r)?"one of ".concat(r.join(", ")):r;return{code:Kt,message:"File type must be ".concat(t)}},fr=function(r){return{code:Bt,message:"File is larger than ".concat(r," ").concat(r===1?"byte":"bytes")}},pr=function(r){return{code:Ht,message:"File is smaller than ".concat(r," ").concat(r===1?"byte":"bytes")}},Ut={code:Wt,message:"Too many files"};function kr(e,r){var t=e.type==="application/x-moz-file"||It(e,r);return[t,t?null:Gt(r)]}function zr(e,r,t){if(W(e.size))if(W(r)&&W(t)){if(e.size>t)return[!1,fr(t)];if(e.size<r)return[!1,pr(r)]}else{if(W(r)&&e.size<r)return[!1,pr(r)];if(W(t)&&e.size>t)return[!1,fr(t)]}return[!0,null]}function W(e){return e!=null}function Vt(e){var r=e.files,t=e.accept,n=e.minSize,o=e.maxSize,i=e.multiple,l=e.maxFiles,c=e.validator;return!i&&r.length>1||i&&l>=1&&r.length>l?!1:r.every(function(d){var h=kr(d,t),w=ae(h,1),b=w[0],C=zr(d,n,o),k=ae(C,1),m=k[0],v=c?c(d):null;return b&&m&&!v})}function Oe(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function he(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(r){return r==="Files"||r==="application/x-moz-file"}):!!e.target&&!!e.target.files}function dr(e){e.preventDefault()}function Yt(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function Zt(e){return e.indexOf("Edge/")!==-1}function qt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Yt(e)||Zt(e)}function T(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(n){for(var o=arguments.length,i=new Array(o>1?o-1:0),l=1;l<o;l++)i[l-1]=arguments[l];return r.some(function(c){return!Oe(n)&&c&&c.apply(void 0,[n].concat(i)),Oe(n)})}}function Jt(){return"showOpenFilePicker"in window}function Qt(e){if(W(e)){var r=Object.entries(e).filter(function(t){var n=ae(t,2),o=n[0],i=n[1],l=!0;return Ir(o)||(console.warn('Skipped "'.concat(o,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),l=!1),(!Array.isArray(i)||!i.every(Tr))&&(console.warn('Skipped "'.concat(o,'" because an invalid file extension was provided.')),l=!1),l}).reduce(function(t,n){var o=ae(n,2),i=o[0],l=o[1];return ur(ur({},t),{},Sr({},i,l))},{});return[{description:"Files",accept:r}]}return e}function Xt(e){if(W(e))return Object.entries(e).reduce(function(r,t){var n=ae(t,2),o=n[0],i=n[1];return[].concat(cr(r),[o],cr(i))},[]).filter(function(r){return Ir(r)||Tr(r)}).join(",")}function en(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function rn(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Ir(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Tr(e){return/^.*\.[\w]+$/.test(e)}var tn=["children"],nn=["open"],on=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],an=["refKey","onChange","onClick"];function sn(e){return un(e)||ln(e)||Rr(e)||cn()}function cn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ln(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function un(e){if(Array.isArray(e))return Ne(e)}function Ie(e,r){return dn(e)||pn(e,r)||Rr(e,r)||fn()}function fn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rr(e,r){if(e){if(typeof e=="string")return Ne(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ne(e,r)}}function Ne(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function pn(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n=[],o=!0,i=!1,l,c;try{for(t=t.call(e);!(o=(l=t.next()).done)&&(n.push(l.value),!(r&&n.length===r));o=!0);}catch(d){i=!0,c=d}finally{try{!o&&t.return!=null&&t.return()}finally{if(i)throw c}}return n}}function dn(e){if(Array.isArray(e))return e}function mr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,n)}return t}function g(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?mr(Object(t),!0).forEach(function(n){Ke(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mr(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ke(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function we(e,r){if(e==null)return{};var t=mn(e,r),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}function mn(e,r){if(e==null)return{};var t={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(r.indexOf(o)>=0)&&(t[o]=e[o]);return t}var Ue=u.forwardRef(function(e,r){var t=e.children,n=we(e,tn),o=Lr(n),i=o.open,l=we(o,nn);return u.useImperativeHandle(r,function(){return{open:i}},[i]),z.createElement(u.Fragment,null,t(g(g({},l),{},{open:i})))});Ue.displayName="Dropzone";var $r={disabled:!1,getFilesFromEvent:xt,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};Ue.defaultProps=$r;Ue.propTypes={children:f.func,accept:f.objectOf(f.arrayOf(f.string)),multiple:f.bool,preventDropOnDocument:f.bool,noClick:f.bool,noKeyboard:f.bool,noDrag:f.bool,noDragEventsBubbling:f.bool,minSize:f.number,maxSize:f.number,maxFiles:f.number,disabled:f.bool,getFilesFromEvent:f.func,onFileDialogCancel:f.func,onFileDialogOpen:f.func,useFsAccessApi:f.bool,autoFocus:f.bool,onDragEnter:f.func,onDragLeave:f.func,onDragOver:f.func,onDrop:f.func,onDropAccepted:f.func,onDropRejected:f.func,onError:f.func,validator:f.func};var Be={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Lr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=g(g({},$r),e),t=r.accept,n=r.disabled,o=r.getFilesFromEvent,i=r.maxSize,l=r.minSize,c=r.multiple,d=r.maxFiles,h=r.onDragEnter,w=r.onDragLeave,b=r.onDragOver,C=r.onDrop,k=r.onDropAccepted,m=r.onDropRejected,v=r.onFileDialogCancel,E=r.onFileDialogOpen,P=r.useFsAccessApi,M=r.autoFocus,R=r.preventDropOnDocument,N=r.noClick,K=r.noKeyboard,B=r.noDrag,S=r.noDragEventsBubbling,A=r.onError,$=r.validator,H=u.useMemo(function(){return Xt(t)},[t]),se=u.useMemo(function(){return Qt(t)},[t]),ee=u.useMemo(function(){return typeof E=="function"?E:gr},[E]),G=u.useMemo(function(){return typeof v=="function"?v:gr},[v]),_=u.useRef(null),j=u.useRef(null),ce=u.useReducer(gn,Be),le=Ie(ce,2),re=le[0],x=le[1],ue=re.isFocused,fe=re.isFileDialogActive,U=u.useRef(typeof window<"u"&&window.isSecureContext&&P&&Jt()),pe=function(){!U.current&&fe&&setTimeout(function(){if(j.current){var s=j.current.files;s.length||(x({type:"closeDialog"}),G())}},300)};u.useEffect(function(){return window.addEventListener("focus",pe,!1),function(){window.removeEventListener("focus",pe,!1)}},[j,fe,G,U]);var I=u.useRef([]),V=function(s){_.current&&_.current.contains(s.target)||(s.preventDefault(),I.current=[])};u.useEffect(function(){return R&&(document.addEventListener("dragover",dr,!1),document.addEventListener("drop",V,!1)),function(){R&&(document.removeEventListener("dragover",dr),document.removeEventListener("drop",V))}},[_,R]),u.useEffect(function(){return!n&&M&&_.current&&_.current.focus(),function(){}},[_,M,n]);var L=u.useCallback(function(a){A?A(a):console.error(a)},[A]),te=u.useCallback(function(a){a.preventDefault(),a.persist(),ye(a),I.current=[].concat(sn(I.current),[a.target]),he(a)&&Promise.resolve(o(a)).then(function(s){if(!(Oe(a)&&!S)){var y=s.length,O=y>0&&Vt({files:s,accept:H,minSize:l,maxSize:i,multiple:c,maxFiles:d,validator:$}),F=y>0&&!O;x({isDragAccept:O,isDragReject:F,isDragActive:!0,type:"setDraggedFiles"}),h&&h(a)}}).catch(function(s){return L(s)})},[o,h,L,S,H,l,i,c,d,$]),de=u.useCallback(function(a){a.preventDefault(),a.persist(),ye(a);var s=he(a);if(s&&a.dataTransfer)try{a.dataTransfer.dropEffect="copy"}catch{}return s&&b&&b(a),!1},[b,S]),me=u.useCallback(function(a){a.preventDefault(),a.persist(),ye(a);var s=I.current.filter(function(O){return _.current&&_.current.contains(O)}),y=s.indexOf(a.target);y!==-1&&s.splice(y,1),I.current=s,!(s.length>0)&&(x({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),he(a)&&w&&w(a))},[_,w,S]),ge=u.useCallback(function(a,s){var y=[],O=[];a.forEach(function(F){var ne=kr(F,H),q=Ie(ne,2),Ae=q[0],Fe=q[1],Pe=zr(F,l,i),De=Ie(Pe,2),Se=De[0],Ce=De[1],ke=$?$(F):null;if(Ae&&Se&&!ke)y.push(F);else{var ze=[Fe,Ce];ke&&(ze=ze.concat(ke)),O.push({file:F,errors:ze.filter(function(Yr){return Yr})})}}),(!c&&y.length>1||c&&d>=1&&y.length>d)&&(y.forEach(function(F){O.push({file:F,errors:[Ut]})}),y.splice(0)),x({acceptedFiles:y,fileRejections:O,type:"setFiles"}),C&&C(y,O,s),O.length>0&&m&&m(O,s),y.length>0&&k&&k(y,s)},[x,c,H,l,i,d,C,k,m,$]),ve=u.useCallback(function(a){a.preventDefault(),a.persist(),ye(a),I.current=[],he(a)&&Promise.resolve(o(a)).then(function(s){Oe(a)&&!S||ge(s,a)}).catch(function(s){return L(s)}),x({type:"reset"})},[o,ge,L,S]),Y=u.useCallback(function(){if(U.current){x({type:"openDialog"}),ee();var a={multiple:c,types:se};window.showOpenFilePicker(a).then(function(s){return o(s)}).then(function(s){ge(s,null),x({type:"closeDialog"})}).catch(function(s){en(s)?(G(s),x({type:"closeDialog"})):rn(s)?(U.current=!1,j.current?(j.current.value=null,j.current.click()):L(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):L(s)});return}j.current&&(x({type:"openDialog"}),ee(),j.current.value=null,j.current.click())},[x,ee,G,P,ge,L,se,c]),Ye=u.useCallback(function(a){!_.current||!_.current.isEqualNode(a.target)||(a.key===" "||a.key==="Enter"||a.keyCode===32||a.keyCode===13)&&(a.preventDefault(),Y())},[_,Y]),Ze=u.useCallback(function(){x({type:"focus"})},[]),qe=u.useCallback(function(){x({type:"blur"})},[]),Je=u.useCallback(function(){N||(qt()?setTimeout(Y,0):Y())},[N,Y]),Z=function(s){return n?null:s},je=function(s){return K?null:Z(s)},be=function(s){return B?null:Z(s)},ye=function(s){S&&s.stopPropagation()},Gr=u.useMemo(function(){return function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=a.refKey,y=s===void 0?"ref":s,O=a.role,F=a.onKeyDown,ne=a.onFocus,q=a.onBlur,Ae=a.onClick,Fe=a.onDragEnter,Pe=a.onDragOver,De=a.onDragLeave,Se=a.onDrop,Ce=we(a,on);return g(g(Ke({onKeyDown:je(T(F,Ye)),onFocus:je(T(ne,Ze)),onBlur:je(T(q,qe)),onClick:Z(T(Ae,Je)),onDragEnter:be(T(Fe,te)),onDragOver:be(T(Pe,de)),onDragLeave:be(T(De,me)),onDrop:be(T(Se,ve)),role:typeof O=="string"&&O!==""?O:"presentation"},y,_),!n&&!K?{tabIndex:0}:{}),Ce)}},[_,Ye,Ze,qe,Je,te,de,me,ve,K,B,n]),Ur=u.useCallback(function(a){a.stopPropagation()},[]),Vr=u.useMemo(function(){return function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=a.refKey,y=s===void 0?"ref":s,O=a.onChange,F=a.onClick,ne=we(a,an),q=Ke({accept:H,multiple:c,type:"file",style:{display:"none"},onChange:Z(T(O,ve)),onClick:Z(T(F,Ur)),tabIndex:-1},y,j);return g(g({},q),ne)}},[j,t,c,ve,n]);return g(g({},re),{},{isFocused:ue&&!n,getRootProps:Gr,getInputProps:Vr,rootRef:_,inputRef:j,open:Z(Y)})}function gn(e,r){switch(r.type){case"focus":return g(g({},e),{},{isFocused:!0});case"blur":return g(g({},e),{},{isFocused:!1});case"openDialog":return g(g({},Be),{},{isFileDialogActive:!0});case"closeDialog":return g(g({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return g(g({},e),{},{isDragActive:r.isDragActive,isDragAccept:r.isDragAccept,isDragReject:r.isDragReject});case"setFiles":return g(g({},e),{},{acceptedFiles:r.acceptedFiles,fileRejections:r.fileRejections});case"reset":return g({},Be);default:return e}}function gr(){}const[vn,bn]=Zr("Dropzone component was not found in tree");var vr=Object.getOwnPropertySymbols,yn=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,hn=(e,r)=>{var t={};for(var n in e)yn.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&vr)for(var n of vr(e))r.indexOf(n)<0&&Dn.call(e,n)&&(t[n]=e[n]);return t};function Ve(e){const r=t=>{const n=He(`Dropzone${er(e)}`,{},t),{children:o}=n,i=hn(n,["children"]),l=bn(),c=qr(o)?o:z.createElement("span",null,o);return l[e]?u.cloneElement(c,i):null};return r.displayName=`@mantine/dropzone/${er(e)}`,r}const _n=Ve("accept"),On=Ve("reject"),wn=Ve("idle");var En=Object.defineProperty,xn=Object.defineProperties,jn=Object.getOwnPropertyDescriptors,br=Object.getOwnPropertySymbols,An=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,yr=(e,r,t)=>r in e?En(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Dr=(e,r)=>{for(var t in r||(r={}))An.call(r,t)&&yr(e,t,r[t]);if(br)for(var t of br(r))Fn.call(r,t)&&yr(e,t,r[t]);return e},Pn=(e,r)=>xn(e,jn(r)),Sn=jr((e,{padding:r,radius:t})=>{const n=e.fn.variant({color:"red",variant:"light"}),o=e.fn.variant({color:e.primaryColor,variant:"light"});return{root:Pn(Dr(Dr({},e.fn.fontStyles()),e.fn.focusStyles()),{boxSizing:"border-box",backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white,border:`${Jr(2)} dashed ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,padding:Qr({size:r,sizes:e.spacing}),borderRadius:e.fn.radius(t),cursor:"pointer",userSelect:"none",transition:"background-color 150ms ease",position:"relative","&:hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]},"&[data-loading]":{cursor:"default","&:hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white}},"&[data-accept]":{backgroundColor:e.colorScheme==="dark"?o.background:e.colors[e.primaryColor][0],borderColor:e.colorScheme==="dark"?o.border:e.colors[e.primaryColor][4],"&:hover":{backgroundColor:e.colorScheme==="dark"?o.background:e.colors[e.primaryColor][0]}},"&[data-reject]":{backgroundColor:e.colorScheme==="dark"?n.background:e.colors.red[0],borderColor:e.colorScheme==="dark"?n.border:e.colors.red[4],"&:hover":{backgroundColor:e.colorScheme==="dark"?n.background:e.colors.red[0]}}}),inner:{pointerEvents:"none",userSelect:"none"}}});const Cn=Sn;var kn=Object.defineProperty,zn=Object.defineProperties,In=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertySymbols,Mr=Object.prototype.hasOwnProperty,Nr=Object.prototype.propertyIsEnumerable,hr=(e,r,t)=>r in e?kn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,oe=(e,r)=>{for(var t in r||(r={}))Mr.call(r,t)&&hr(e,t,r[t]);if(Ee)for(var t of Ee(r))Nr.call(r,t)&&hr(e,t,r[t]);return e},Te=(e,r)=>zn(e,In(r)),Tn=(e,r)=>{var t={};for(var n in e)Mr.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&Ee)for(var n of Ee(e))r.indexOf(n)<0&&Nr.call(e,n)&&(t[n]=e[n]);return t};const Rn={padding:"md",loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,useFsAccessApi:!0};function X(e){const r=He("Dropzone",Rn,e),{className:t,padding:n,radius:o,disabled:i,classNames:l,styles:c,loading:d,multiple:h,maxSize:w,accept:b,children:C,onDropAny:k,onDrop:m,onReject:v,openRef:E,name:P,unstyled:M,maxFiles:R,autoFocus:N,activateOnClick:K,activateOnDrag:B,dragEventsBubbling:S,activateOnKeyboard:A,onDragEnter:$,onDragLeave:H,onDragOver:se,onFileDialogCancel:ee,onFileDialogOpen:G,preventDropOnDocument:_,useFsAccessApi:j,getFilesFromEvent:ce,validator:le,variant:re}=r,x=Tn(r,["className","padding","radius","disabled","classNames","styles","loading","multiple","maxSize","accept","children","onDropAny","onDrop","onReject","openRef","name","unstyled","maxFiles","autoFocus","activateOnClick","activateOnDrag","dragEventsBubbling","activateOnKeyboard","onDragEnter","onDragLeave","onDragOver","onFileDialogCancel","onFileDialogOpen","preventDropOnDocument","useFsAccessApi","getFilesFromEvent","validator","variant"]),{classes:ue,cx:fe}=Cn({radius:o,padding:n},{name:"Dropzone",classNames:l,styles:c,unstyled:M,variant:re}),{getRootProps:U,getInputProps:pe,isDragAccept:I,isDragReject:V,open:L}=Lr(oe({onDrop:k,onDropAccepted:m,onDropRejected:v,disabled:i||d,accept:Array.isArray(b)?b.reduce((de,me)=>Te(oe({},de),{[me]:[]}),{}):b,multiple:h,maxSize:w,maxFiles:R,autoFocus:N,noClick:!K,noDrag:!B,noDragEventsBubbling:!S,noKeyboard:!A,onDragEnter:$,onDragLeave:H,onDragOver:se,onFileDialogCancel:ee,onFileDialogOpen:G,preventDropOnDocument:_,useFsAccessApi:j,validator:le},ce?{getFilesFromEvent:ce}:null));Xr(E,L);const te=!I&&!V;return z.createElement(vn,{value:{accept:I,reject:V,idle:te}},z.createElement(Ar,Te(oe(oe({},x),U()),{"data-accept":I||void 0,"data-reject":V||void 0,"data-idle":te||void 0,"data-loading":d||void 0,className:fe(ue.root,t)}),z.createElement(et,{visible:d,radius:o,unstyled:M}),z.createElement("input",Te(oe({},pe()),{name:P})),z.createElement("div",{className:ue.inner},C)))}X.displayName="@mantine/dropzone/Dropzone";X.Accept=_n;X.Reject=On;X.Idle=wn;const Kr=X;var $n=Object.defineProperty,Ln=Object.defineProperties,Mn=Object.getOwnPropertyDescriptors,_r=Object.getOwnPropertySymbols,Nn=Object.prototype.hasOwnProperty,Kn=Object.prototype.propertyIsEnumerable,Or=(e,r,t)=>r in e?$n(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Bn=(e,r)=>{for(var t in r||(r={}))Nn.call(r,t)&&Or(e,t,r[t]);if(_r)for(var t of _r(r))Kn.call(r,t)&&Or(e,t,r[t]);return e},Hn=(e,r)=>Ln(e,Mn(r)),Wn=jr(e=>({wrapper:Hn(Bn({},e.fn.cover(0)),{position:"fixed",backgroundColor:e.colorScheme==="dark"?e.colors.dark[7]:e.white,display:"flex",padding:e.spacing.xs,transition:"opacity 100ms ease"}),dropzone:{flex:1}}));const Gn=Wn;var Un=Object.defineProperty,Vn=Object.defineProperties,Yn=Object.getOwnPropertyDescriptors,xe=Object.getOwnPropertySymbols,Br=Object.prototype.hasOwnProperty,Hr=Object.prototype.propertyIsEnumerable,wr=(e,r,t)=>r in e?Un(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Re=(e,r)=>{for(var t in r||(r={}))Br.call(r,t)&&wr(e,t,r[t]);if(xe)for(var t of xe(r))Hr.call(r,t)&&wr(e,t,r[t]);return e},$e=(e,r)=>Vn(e,Yn(r)),Zn=(e,r)=>{var t={};for(var n in e)Br.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&xe)for(var n of xe(e))r.indexOf(n)<0&&Hr.call(e,n)&&(t[n]=e[n]);return t};const qn={padding:"md",loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,active:!0,zIndex:rt("max"),withinPortal:!0};function Wr(e){const r=He("DropzoneFullScreen",qn,e),{classNames:t,styles:n,sx:o,className:i,style:l,unstyled:c,active:d,onDrop:h,onReject:w,zIndex:b,withinPortal:C,portalProps:k}=r,m=Zn(r,["classNames","styles","sx","className","style","unstyled","active","onDrop","onReject","zIndex","withinPortal","portalProps"]),[v,E]=z.useState(0),[P,{open:M,close:R}]=tt(!1),{classes:N,cx:K}=Gn(null,{name:"DropzoneFullScreen",classNames:t,styles:n,unstyled:c}),B=A=>{A.dataTransfer.types.includes("Files")&&(E($=>$+1),M())},S=()=>{E(A=>A-1)};return u.useEffect(()=>{v===0&&R()},[v]),u.useEffect(()=>{if(d)return document.addEventListener("dragenter",B,!1),document.addEventListener("dragleave",S,!1),()=>{document.removeEventListener("dragenter",B,!1),document.removeEventListener("dragleave",S,!1)}},[d]),z.createElement(nt,$e(Re({},k),{withinPortal:C}),z.createElement(Ar,{className:K(N.wrapper,i),sx:o,style:$e(Re({},l),{opacity:P?1:0,pointerEvents:P?"all":"none",zIndex:b})},z.createElement(X,$e(Re({},m),{classNames:t,styles:n,unstyled:c,className:N.dropzone,onDrop:A=>{h==null||h(A),R()},onReject:A=>{w==null||w(A),R()}}))))}Wr.displayName="@mantine/dropzone/DropzoneFullScreen";Kr.FullScreen=Wr;const Er=Kr;function Jn(e){var n;switch(((n=e.split(".").pop())==null?void 0:n.toLowerCase())??""){case"pdf":return p.jsx(ut,{size:18});case"csv":return p.jsx(lt,{size:18});case"xls":case"xlsx":return p.jsx(ct,{size:18});case"doc":case"docx":return p.jsx(st,{size:18});case"zip":case"tar":case"gz":case"7z":return p.jsx(it,{size:18});case"png":case"jpg":case"jpeg":case"gif":case"bmp":case"tif":case"webp":return p.jsx(at,{size:18});default:return p.jsx(ot,{size:18})}}function Qn({attachment:e}){return p.jsxs(We,{position:"left",spacing:"sm",children:[Jn(e),p.jsx(Ge,{children:e.split("/").pop()})]})}function xr({endpoint:e,model:r,pk:t,attachmentType:n,callback:o}){let i={attachment:{},link:{},comment:{}};n==="link"?delete i.attachment:delete i.link,i[r]={value:t,hidden:!0};let l=n==="file"?D._({id:"8uQpHD"}):D._({id:"V4WsyL"}),c=n==="file"?D._({id:"TzSMET"}):D._({id:"GvlLvd"});gt({title:l,url:e,successMessage:c,fields:i,onFormSuccess:o})}function Xn({endpoint:e,model:r,pk:t,attachmentType:n,callback:o}){let i={link:{},comment:{}};n==="file"&&delete i.link,i[r]={value:t,hidden:!0};let l=n==="file"?D._({id:"xtmR+6"}):D._({id:"gDx5MG"}),c=n==="file"?D._({id:"TKcCLO"}):D._({id:"AEUkAQ"});vt({title:l,url:e,pk:t,successMessage:c,fields:i,onFormSuccess:o})}function eo({endpoint:e,pk:r,callback:t}){bt({url:e,pk:r,title:D._({id:"hZfPb3"}),successMessage:D._({id:"iDEbsu"}),onFormSuccess:t,fields:{},preFormWarning:D._({id:"1oL0IJ"})})}function ro(){return[{accessor:"attachment",sortable:!1,switchable:!1,noWrap:!0,render:function(e){return e.attachment?p.jsx(Qn,{attachment:e.attachment}):e.link?e.link:"-"}},{accessor:"comment",sortable:!1,render:function(e){return e.comment}},{accessor:"upload_date",sortable:!0,render:function(e){return p.jsxs(We,{position:"apart",children:[p.jsx(Ge,{children:e.upload_date}),e.user_detail&&p.jsx(dt,{size:"xs",children:e.user_detail.username})]})}}]}function io({endpoint:e,model:r,pk:t}){const n=yt(`${r}-attachments`),o=u.useMemo(()=>ro(),[]),[i,l]=u.useState(!1),[c,d]=u.useState(!1),h=u.useMemo(()=>mt(e),[e]),w=u.useMemo(()=>t>0,[t]);u.useEffect(()=>{ar.options(h).then(m=>{var E;let v=((E=m.data)==null?void 0:E.actions)??{};return l("POST"in v),d("DELETE"in v),m}).catch(m=>m)},[]);const b=u.useCallback(m=>{let v=[];return i&&v.push(Dt({onClick:()=>{Xn({endpoint:e,model:r,pk:m.pk,attachmentType:m.attachment?"file":"link",callback:n.refreshTable})}})),c&&v.push(ht({onClick:()=>{eo({endpoint:e,pk:m.pk,callback:n.refreshTable})}})),v},[i,c]);function C(m){m.forEach(v=>{let E=new FormData;E.append("attachment",v),E.append(r,t.toString()),ar.post(h,E).then(P=>(or.show({title:D._({id:"FJqE4H"}),message:D._({id:"3LxYDr",values:{0:v.name}}),color:"green"}),n.refreshTable(),P)).catch(P=>(console.error("error uploading attachment:",v,"->",P),or.show({title:D._({id:"ae3dey"}),message:D._({id:"GZnmeE"}),color:"red"}),P))})}const k=u.useMemo(()=>{let m=[];return i&&(m.push(p.jsx(rr,{label:D._({id:"V8euYO"}),children:p.jsx(tr,{radius:"sm",onClick:()=>{xr({endpoint:e,model:r,pk:t,attachmentType:"file",callback:n.refreshTable})},children:p.jsx(nr,{})})},"attachment-add")),m.push(p.jsx(rr,{label:D._({id:"DpV4ac"}),children:p.jsx(tr,{radius:"sm",onClick:()=>{xr({endpoint:e,model:r,pk:t,attachmentType:"link",callback:n.refreshTable})},children:p.jsx(ft,{})})},"link-add"))),m},[i]);return p.jsxs(pt,{spacing:"xs",children:[t&&t>0&&p.jsx(_t,{url:h,tableState:n,columns:o,props:{noRecordsText:D._({id:"32o8IC"}),enableSelection:!0,tableActions:k,rowActions:i&&c?b:void 0,params:{[r]:t}}},"attachment-table"),i&&w&&p.jsx(Er,{onDrop:C,children:p.jsx(Er.Idle,{children:p.jsxs(We,{position:"center",children:[p.jsx(nr,{size:24}),p.jsx(Ge,{size:"sm",children:D._({id:"VHmXZm"})})]})})},"attachment-dropzone")]})}export{io as A,Er as D,Qn as a};
