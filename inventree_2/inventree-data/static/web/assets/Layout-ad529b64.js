import{r as f,j as e,$ as C,i as u,A as L,g as P,G as g,a0 as je,a1 as j,a2 as G,h as k,a3 as Q,a4 as pe,a5 as me,a6 as ae,a7 as fe,a8 as ge,a9 as ne,aa as M,ab as Se,D as Z,o as _e,ac as X,u as ke,ad as ie,T as D,U as Re,E as y,x as Y,ae as Ce,S as O,m as ve,af as K,ag as we,ah as be,ai as Ee,aj as ye,ak as q,al as Ie,am as De,an as se,C as Te,L as Le,ao as Oe,ap as He,P as Ne,aq as U,ar as ze,as as Pe,at as B}from"./vendor-580d7f6a.js";import{I as w,S as Ve}from"./StylishText-5ee5b946.js";import{a as oe,j as Ae,I as We,u as Fe,f as Me,i as H,A as N,g as z,c as Ue,M as _,U as m,d as Be}from"./index-539d0685.js";import{f as Qe,n as Ke,a as qe,b as Je}from"./links-65930103.js";import{N as Ge,u as V,L as T,a as Ze,O as Xe,b as Ye}from"./DesktopAppView-f36ad07f.js";import{o as $e,T as o}from"./BaseContext-71d55e61.js";import{D as le}from"./DocTooltip-119b7cc3.js";import{P as es}from"./Placeholder-f60056df.js";import{R as ss}from"./Instance-4f17d9b0.js";import{M as ce}from"./ModelType-07300e1e.js";const ts="/assets/inventree-19c9a929.svg",rs=f.forwardRef((s,a)=>e.jsx("div",{ref:a,...s,children:e.jsx(Ge,{to:"/",children:e.jsx(C,{size:28,children:e.jsx(de,{})})})})),de=()=>e.jsx("img",{src:ts,alt:u._({id:"DVAy0b"}),height:28});function as(){const{classes:s}=w(),a=Qe.map(t=>e.jsx(L,{color:"dimmed",href:t.link,onClick:r=>r.preventDefault(),size:"sm",children:t.label},t.key));return e.jsx("div",{className:s.layoutFooter,children:e.jsxs(P,{className:s.layoutFooterInner,size:"100%",children:[e.jsx(rs,{}),e.jsx(g,{className:s.layoutFooterLinks,children:a})]})})}function ns(){return e.jsx(C,{onClick:()=>$e({modal:"qr",title:u._({id:"XDwkfO"}),innerProps:{}}),children:e.jsx(je,{})})}function is(){var n,h,S;const s=V(),{classes:a,theme:t}=w(),r=oe();return e.jsxs(j,{width:260,position:"bottom-end",children:[e.jsx(j.Target,{children:e.jsx(G,{className:a.layoutHeaderUser,children:e.jsxs(g,{spacing:7,children:[e.jsx(k,{weight:500,size:"sm",sx:{lineHeight:1},mr:3,children:r.username()?r.username():e.jsx(Q,{height:20,width:40,radius:t.defaultRadius})}),e.jsx(pe,{})]})})}),e.jsxs(j.Dropdown,{children:[e.jsx(j.Label,{children:e.jsx(o,{id:"Tz0i8g"})}),e.jsx(j.Item,{icon:e.jsx(me,{}),component:T,to:"/settings/user",children:e.jsx(o,{id:"T3FM0r"})}),((n=r.user)==null?void 0:n.is_staff)&&e.jsx(j.Item,{icon:e.jsx(ae,{}),component:T,to:"/settings/system",children:e.jsx(o,{id:"zNkWa6"})}),((h=r.user)==null?void 0:h.is_staff)&&e.jsx(j.Divider,{}),((S=r.user)==null?void 0:S.is_staff)&&e.jsx(j.Item,{icon:e.jsx(fe,{}),component:T,to:"/settings/admin",children:e.jsx(o,{id:"uTLn08"})}),e.jsx(j.Divider,{}),e.jsx(j.Item,{icon:e.jsx(ge,{}),onClick:()=>{Ae(s)},children:e.jsx(o,{id:"nOhz3x"})})]})]})}const $=[{id:"home",text:e.jsx(o,{id:"i0qMbr"}),link:"/",highlight:!0},{id:"profile",text:e.jsx(o,{id:"T3FM0r"}),link:"/settings/user",doctext:e.jsx(o,{id:"CFYxhi"})},{id:"scan",text:e.jsx(o,{id:"CMQ09J"}),link:"/scan",doctext:e.jsx(o,{id:"PrR19h"}),highlight:!0},{id:"dashboard",text:e.jsx(o,{id:"7p5kLi"}),link:"/dashboard"},{id:"parts",text:e.jsx(o,{id:"pmRbKZ"}),link:"/part/"},{id:"stock",text:e.jsx(o,{id:"blbbPS"}),link:"/stock"},{id:"build",text:e.jsx(o,{id:"iSiFYa"}),link:"/build/"},{id:"purchasing",text:e.jsx(o,{id:"UOTpFa"}),link:"/purchasing/"},{id:"sales",text:e.jsx(o,{id:"mUv9U4"}),link:"/sales/"},{id:"settings-system",text:e.jsx(o,{id:"zNkWa6"}),link:"/settings/system"},{id:"settings-admin",text:e.jsx(o,{id:"uTLn08"}),link:"/settings/admin"}];We&&$.push({id:"playground",text:e.jsx(o,{id:"0LrFTO"}),link:"/playground",highlight:!0});function os({item:s,children:a}){return s.doctext!==void 0?e.jsx(le,{text:s.doctext,detail:s==null?void 0:s.docdetail,link:s==null?void 0:s.doclink,docchildren:s==null?void 0:s.docchildren,children:a},s.id):e.jsx(e.Fragment,{children:a})}function J({links:s,highlighted:a}){const{classes:t}=w();a=a||!1;const r=s.filter(n=>!a||n.highlight===!0);return e.jsx(ne,{cols:2,spacing:0,children:r.map(n=>e.jsx(os,{item:n,children:e.jsx(G,{className:t.subLink,component:T,to:n.link,p:0,children:e.jsx(k,{size:"sm",fw:500,children:n.text})})},n.id))})}function ls({openDrawer:s}){const{classes:a,theme:t}=w(),[r,n]=Fe(i=>[i.hostKey,i.hostList]),[h]=Me(i=>[i.server.instance]),[S,R]=f.useState();return f.useEffect(()=>{var i;r&&n[r]&&R((i=n[r])==null?void 0:i.name)},[r]),e.jsxs(M,{width:600,openDelay:300,position:"bottom",shadow:"md",withinPortal:!0,children:[e.jsx(M.Target,{children:e.jsx(G,{onClick:()=>s(),children:e.jsx(de,{})})}),e.jsxs(M.Dropdown,{sx:{overflow:"hidden"},children:[e.jsxs(g,{position:"apart",px:"md",children:[e.jsx(C,{onClick:s,onMouseOver:s,title:u._({id:"rmlxV1"}),children:e.jsx(Se,{})}),e.jsxs(g,{spacing:"xs",children:[S||e.jsx(Q,{height:20,width:40,radius:t.defaultRadius})," ","|"," ",h||e.jsx(Q,{height:20,width:40,radius:t.defaultRadius})]}),e.jsx(L,{href:"#",fz:"xs",onClick:s,children:e.jsx(o,{id:"N6Pxr9"})})]}),e.jsx(Z,{my:"sm",mx:"-md",color:t.colorScheme==="dark"?"dark.5":"gray.1"}),e.jsx(J,{links:$,highlighted:!0}),e.jsx("div",{className:a.headerDropdownFooter,children:e.jsxs(g,{position:"apart",children:[e.jsxs("div",{children:[e.jsx(k,{fw:500,fz:"sm",children:e.jsx(o,{id:"ZDIydz"})}),e.jsx(k,{size:"xs",color:"dimmed",children:e.jsx(o,{id:"BQDL+H"})})]}),e.jsx(_e,{variant:"default",children:e.jsx(o,{id:"ZDIydz"})})]})})]})]})}function te({links:s}){const a=({link:t})=>{const r=e.jsx(k,{size:"sm",fw:500,children:t.title}),n=({children:h})=>t.link?e.jsx(L,{href:t.link,children:h},t.id):t.action?e.jsx(L,{component:"button",type:"button",onClick:t.action,children:h}):(console.log("Neither link nor action found for link:",t),h);return e.jsx(n,{children:t.placeholder?e.jsxs(g,{children:[r,e.jsx(es,{})]}):r})};return e.jsx(ne,{cols:2,spacing:0,children:s.map(t=>e.jsx(le,{text:t.description,children:e.jsx(a,{link:t})},t.id))})}const re=[];function cs({opened:s,close:a}){const{classes:t}=w();return e.jsx(X,{opened:s,onClose:a,overlayProps:{opacity:.5,blur:4},withCloseButton:!1,classNames:{body:t.navigationDrawer},children:e.jsx(ds,{})})}function ds(){const{classes:s}=w(),[a,t]=f.useState(0),r=f.useRef(null),{height:n}=ke();return f.useEffect(()=>{r.current!=null&&t(n-r.current.clientHeight-65)}),e.jsxs(ie,{direction:"column",mih:"100vh",p:16,children:[e.jsx(D,{order:3,children:u._({id:"UxKoFf"})}),e.jsx(P,{className:s.layoutContent,p:0,children:e.jsxs(Re,{h:a,type:"always",offsetScrollbars:!0,children:[e.jsx(D,{order:5,children:u._({id:"wRR604"})}),e.jsx(J,{links:$}),e.jsx(y,{h:"md"}),re.length>0?e.jsxs(e.Fragment,{children:[e.jsx(D,{order:5,children:u._({id:"ohUJJM"})}),e.jsx(J,{links:re})]}):e.jsx(e.Fragment,{})]})}),e.jsxs("div",{ref:r,children:[e.jsx(y,{h:"md"}),e.jsx(D,{order:5,children:u._({id:"TvY/XA"})}),e.jsx(te,{links:Ke}),e.jsx(y,{h:"md"}),e.jsx(D,{order:5,children:u._({id:"uyJsf6"})}),e.jsx(te,{links:qe})]})]})}function us({opened:s,onClose:a}){var n,h,S,R;const t=V(),r=Y({enabled:s,queryKey:["notifications",s],queryFn:async()=>z.get(H(N.notifications_list),{params:{read:!1,limit:10}}).then(i=>i.data).catch(i=>i),refetchOnMount:!1,refetchOnWindowFocus:!1});return e.jsx(X,{opened:s,size:"md",position:"right",onClose:a,withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(g,{position:"apart",noWrap:!0,children:[e.jsx(Ve,{size:"lg",children:u._({id:"iDNBZe"})}),e.jsx(C,{onClick:()=>{a(),t("/notifications/unread")},children:e.jsx(Ce,{})})]}),children:e.jsxs(O,{spacing:"xs",children:[e.jsx(Z,{}),e.jsx(ve,{visible:r.isFetching}),(((h=(n=r.data)==null?void 0:n.results)==null?void 0:h.length)??0)==0&&e.jsx(K,{color:"green",children:e.jsx(k,{size:"sm",children:u._({id:"t2pqHO"})})}),(R=(S=r.data)==null?void 0:S.results)==null?void 0:R.map(i=>{var c,x,I,b;return e.jsxs(g,{position:"apart",children:[e.jsxs(O,{spacing:"3",children:[(c=i==null?void 0:i.target)!=null&&c.link?e.jsx(k,{size:"sm",component:T,to:(x=i==null?void 0:i.target)==null?void 0:x.link,target:"_blank",children:((I=i.target)==null?void 0:I.name)??i.name??u._({id:"5+87Pq"})}):e.jsx(k,{size:"sm",children:((b=i.target)==null?void 0:b.name)??i.name??u._({id:"5+87Pq"})}),e.jsx(k,{size:"xs",children:i.age_human??""})]}),e.jsx(y,{}),e.jsx(C,{color:"gray",variant:"hover",onClick:()=>{let E=H(N.notifications_list,i.pk);z.patch(E,{read:!0}).then(p=>{r.refetch()})},children:e.jsx(we,{label:u._({id:"+s1J8k"}),children:e.jsx(be,{})})})]},i.pk)})]})})}function hs({query:s,onRemove:a,onResultClick:t}){if(s.results.count==0)return null;const r=ce[s.model];return e.jsx(He,{shadow:"sm",radius:"xs",p:"md",children:e.jsxs(O,{children:[e.jsxs(g,{position:"apart",noWrap:!0,children:[e.jsxs(g,{position:"left",spacing:5,noWrap:!0,children:[e.jsx(k,{size:"lg",children:r.label_multiple}),e.jsxs(k,{size:"sm",italic:!0,children:[" ","- ",s.results.count," ",e.jsx(o,{id:"mO8KLE"})]})]}),e.jsx(y,{}),e.jsx(C,{size:"sm",color:"red",variant:"transparent",radius:"xs",onClick:()=>a(s.model),children:e.jsx(Ne,{})})]}),e.jsx(Z,{}),e.jsx(O,{children:s.results.results.map(n=>e.jsx(L,{onClick:()=>t(s.model,n.pk),children:e.jsx(ss,{instance:n,model:s.model})},n.pk))}),e.jsx(y,{})]},`stack-${s.model}`)},`paper-${s.model}`)}function xs({opened:s,onClose:a}){const[t,r]=f.useState(""),[n]=Ee(t,500),[h,S]=f.useState(!1),[R,i]=f.useState(!1),c=oe(),x=Ue(),b=f.useMemo(()=>[{model:_.part,parameters:{},enabled:c.hasViewRole(m.part)&&x.isSet("SEARCH_PREVIEW_SHOW_PARTS")},{model:_.supplierpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:c.hasViewRole(m.part)&&c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS")},{model:_.manufacturerpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:c.hasViewRole(m.part)&&c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS")},{model:_.partcategory,parameters:{},enabled:c.hasViewRole(m.part_category)&&x.isSet("SEARCH_PREVIEW_SHOW_CATEGORIES")},{model:_.stockitem,parameters:{part_detail:!0,location_detail:!0},enabled:c.hasViewRole(m.stock)&&x.isSet("SEARCH_PREVIEW_SHOW_STOCK")},{model:_.stocklocation,parameters:{},enabled:c.hasViewRole(m.stock_location)&&x.isSet("SEARCH_PREVIEW_SHOW_LOCATIONS")},{model:_.build,parameters:{part_detail:!0},enabled:c.hasViewRole(m.build)&&x.isSet("SEARCH_PREVIEW_SHOW_BUILD_ORDERS")},{model:_.company,parameters:{},enabled:(c.hasViewRole(m.sales_order)||c.hasViewRole(m.purchase_order))&&x.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:_.purchaseorder,parameters:{supplier_detail:!0},enabled:c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS")},{model:_.salesorder,parameters:{customer_detail:!0},enabled:c.hasViewRole(m.sales_order)&&x.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDERS")},{model:_.returnorder,parameters:{customer_detail:!0},enabled:c.hasViewRole(m.return_order)&&x.isSet("SEARCH_PREVIEW_SHOW_RETURN_ORDERS")}],[c,x]).filter(l=>l.enabled);f.useEffect(()=>{p.refetch()},[n]);const p=Y({queryKey:["search",n,h,R],queryFn:async()=>{if(!n)return[];let l={offset:0,limit:10,search:n,search_regex:h,search_whole:R};return b.forEach(d=>{l[d.model]=d.parameters}),z.post(H(N.api_search),l).then(function(d){return d.data}).catch(function(d){return console.error(d),[]})},refetchOnWindowFocus:!1}),[A,W]=f.useState([]);f.useEffect(()=>{if(p.data){let l=b.filter(d=>d.model in p.data);for(let d in p.data){let v=l.find(F=>F.model==d);v&&(v.results=p.data[d])}l=l.filter(d=>d.results.count>0),W(l)}else W([])},[p.data]);function ue(l){W(A.filter(d=>d.model!=l))}function ee(){r(""),a()}const he=V();function xe(l,d){ee();const v=ce[l];v.url_detail!=null&&he(v.url_detail.replace(":pk",d.toString()))}return e.jsxs(X,{opened:s,size:"xl",onClose:ee,position:"right",withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(g,{position:"apart",spacing:1,noWrap:!0,children:[e.jsx(ye,{placeholder:u._({id:"Dwt0g3"}),radius:"xs",value:t,onChange:l=>r(l.currentTarget.value),icon:e.jsx(q,{size:"0.8rem"}),rightSection:t&&e.jsx(Ie,{color:"red",onClick:()=>r("")}),styles:{root:{width:"100%"}}}),e.jsx(C,{size:"lg",variant:"outline",radius:"xs",onClick:()=>p.refetch(),children:e.jsx(De,{})}),e.jsxs(j,{children:[e.jsx(j.Target,{children:e.jsx(C,{size:"lg",variant:"outline",radius:"xs",children:e.jsx(ae,{})})}),e.jsxs(j.Dropdown,{children:[e.jsx(j.Label,{children:u._({id:"9UYKcs"})}),e.jsx(j.Item,{children:e.jsx(se,{label:u._({id:"qkCZlJ"}),checked:h,onChange:l=>S(l.currentTarget.checked),radius:"sm"})}),e.jsx(j.Item,{children:e.jsx(se,{label:u._({id:"roauu/"}),checked:R,onChange:l=>i(l.currentTarget.checked),radius:"sm"})})]})]})]}),children:[p.isFetching&&e.jsx(Te,{children:e.jsx(Le,{})}),!p.isFetching&&!p.isError&&e.jsx(O,{spacing:"md",children:A.map((l,d)=>e.jsx(hs,{query:l,onRemove:v=>ue(v),onResultClick:(v,F)=>xe(v,F)},d))}),p.isError&&e.jsx(K,{color:"red",radius:"sm",variant:"light",title:u._({id:"SlfejT"}),icon:e.jsx(Oe,{size:"1rem"}),children:e.jsx(o,{id:"hJCuaV"})}),n&&!p.isFetching&&!p.isError&&A.length==0&&e.jsx(K,{color:"blue",radius:"sm",variant:"light",title:u._({id:"Ev2r9A"}),icon:e.jsx(q,{size:"1rem"}),children:e.jsx(o,{id:"dTtbrX"})})]})}function js(){const{classes:s}=w(),[a,{open:t,close:r}]=U(!1),[n,{open:h,close:S}]=U(!1),[R,{open:i,close:c}]=U(!1),[x,I]=f.useState(0),b=Y({queryKey:["notification-count"],queryFn:async()=>z.get(H(N.notifications_list),{params:{read:!1,limit:1}}).then(E=>(I(E.data.count),E.data)).catch(E=>E),refetchInterval:3e4,refetchOnMount:!0,refetchOnWindowFocus:!1});return e.jsxs("div",{className:s.layoutHeader,children:[e.jsx(xs,{opened:n,onClose:S}),e.jsx(cs,{opened:a,close:r}),e.jsx(us,{opened:R,onClose:()=>{b.refetch(),c()}}),e.jsx(P,{className:s.layoutHeaderSection,size:"100%",children:e.jsxs(g,{position:"apart",children:[e.jsxs(g,{children:[e.jsx(ls,{openDrawer:t}),e.jsx(ps,{})]}),e.jsxs(g,{children:[e.jsx(C,{onClick:h,children:e.jsx(q,{})}),e.jsx(ns,{}),e.jsx(C,{onClick:i,children:e.jsx(ze,{radius:"lg",size:"18",label:x,color:"red",disabled:x<=0,children:e.jsx(Pe,{})})}),e.jsx(is,{})]})]})})]})}function ps(){const{classes:s}=w(),{tabValue:a}=Ze(),t=V();return e.jsx(B,{defaultValue:"home",classNames:{root:s.tabs,tabsList:s.tabsList,tab:s.tab},value:a,onTabChange:r=>r=="/"?t("/"):t(`/${r}`),children:e.jsx(B.List,{children:Je.map(r=>e.jsx(B.Tab,{value:r.name,children:r.text},r.name))})})}const ms=({children:s})=>{const[a]=Be(t=>[t.token]);return a?s:e.jsx(Ye,{to:"/logged-in",replace:!0})};function Es(){const{classes:s}=w();return e.jsx(ms,{children:e.jsxs(ie,{direction:"column",mih:"100vh",children:[e.jsx(js,{}),e.jsx(P,{className:s.layoutContent,size:"100%",children:e.jsx(Xe,{})}),e.jsx(y,{h:"xl"}),e.jsx(as,{})]})})}export{ms as ProtectedRoute,Es as default};
