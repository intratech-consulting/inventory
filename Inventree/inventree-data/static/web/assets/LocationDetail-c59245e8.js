import{r as i,i as o,j as t,a3 as I,h,ay as T,b6 as A,b$ as F,S as M,m as P}from"./vendor-580d7f6a.js";import{I as D,D as j}from"./ItemDetails-8f9834aa.js";import{P as L}from"./PageDetail-e83b8dc6.js";import{P as R}from"./PanelGroup-ecf19d17.js";import{S as v}from"./StockLocationTree-19a73abe.js";import{a as w,A as u,M as x,U as y,i as B}from"./index-539d0685.js";import{u as N}from"./UseInstance-05463349.js";import{S as U}from"./StockItemTable-b84d5ecc.js";import{A as E}from"./AddItemButton-9bde5586.js";import{s as g}from"./StockForms-2847fb41.js";import{g as S}from"./urls-9eea01e5.js";import{a as J,u as O}from"./UseForm-5e9a21d6.js";import{u as K,R as V,I as W}from"./InvenTreeTable-7dffc519.js";import{D as Q,B as C}from"./ColumnRenderers-c7f5177c.js";import{u as z,a as G}from"./DesktopAppView-f36ad07f.js";import"./ProgressBar-f667695e.js";import"./YesNoButton-cd4c504e.js";import"./ModelType-07300e1e.js";import"./Instance-4f17d9b0.js";import"./StylishText-5ee5b946.js";import"./Placeholder-f60056df.js";import"./BaseContext-71d55e61.js";import"./index.es-6e6e8db2.js";import"./ApiForm-173d0ec5.js";import"./notifications-b554622d.js";function Y({parentId:n}){const a=K("stocklocation"),r=w(),m=z(),e=i.useMemo(()=>[{name:"cascade",label:o._({id:"VY386J"}),description:o._({id:"Ue7Vtx"})},{name:"structural",description:o._({id:"zW8WBT"})},{name:"external",description:o._({id:"ckSQBM"})},{name:"has_location_type",label:o._({id:"Sgyhpp"})}],[]),f=i.useMemo(()=>[{accessor:"name",switchable:!1},Q({}),{accessor:"pathstring",sortable:!0},{accessor:"items",sortable:!0},C({accessor:"structural"}),C({accessor:"external"}),{accessor:"location_type",sortable:!1,render:s=>{var d;return(d=s.location_type_detail)==null?void 0:d.name}}],[]),l=J({url:u.stock_location_list,title:o._({id:"sklcDg"}),fields:g({}),initialData:{parent:n},onFormSuccess(s){s.pk?m(S(x.stocklocation,s.pk)):a.refreshTable()}}),[b,k]=i.useState(-1),p=O({url:u.stock_location_list,pk:b,title:o._({id:"Qdjbg8"}),fields:g({}),onFormSuccess:a.refreshTable}),c=i.useMemo(()=>{let s=r.hasAddRole(y.stock_location);return[t.jsx(E,{tooltip:o._({id:"sklcDg"}),onClick:()=>l.open(),hidden:!s})]},[r]),_=i.useCallback(s=>{let d=r.hasChangeRole(y.stock_location);return[V({hidden:!d,onClick:()=>{k(s.pk),p.open()}})]},[r]);return t.jsxs(t.Fragment,{children:[l.modal,p.modal,t.jsx(W,{url:B(u.stock_location_list),tableState:a,columns:f,props:{enableDownload:!0,params:{parent:n},tableFilters:e,tableActions:c,rowActions:_,onRowClick:s=>{m(S(x.stocklocation,s.pk))}}})]})}function je(){const{id:n}=G(),a=i.useMemo(()=>isNaN(parseInt(n||""))?void 0:n,[n]),[r,m]=i.useState(!1),{instance:e,refreshInstance:f,instanceQuery:l}=N({endpoint:u.stock_location_list,hasPrimaryKey:!0,pk:a,params:{path_detail:!0}}),b=i.useMemo(()=>{if(a&&l.isFetching)return t.jsx(I,{});let c=[{type:"text",name:"name",label:o._({id:"6YtxFj"}),copy:!0},{type:"text",name:"pathstring",label:o._({id:"I6gXOa"}),icon:"sitemap",copy:!0,hidden:!a},{type:"text",name:"description",label:o._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"parent",model_field:"name",icon:"location",label:o._({id:"+o9hiJ"}),model:x.stocklocation,hidden:!(e!=null&&e.parent)}],_=[{type:"text",name:"items",icon:"stock",label:o._({id:"Jbck4N"})},{type:"text",name:"sublocations",icon:"location",label:o._({id:"L7/8CO"}),hidden:!(e!=null&&e.sublocations)},{type:"boolean",name:"structural",label:o._({id:"PRKZBP"}),icon:"sitemap"},{type:"boolean",name:"external",label:o._({id:"bVhrVt"})}];return t.jsxs(D,{children:[a&&(e!=null&&e.pk)?t.jsx(j,{item:e,fields:c}):t.jsx(h,{children:o._({id:"js9HzF"})}),a&&(e==null?void 0:e.pk)&&t.jsx(j,{item:e,fields:_})]})},[e,l]),k=i.useMemo(()=>[{name:"details",label:o._({id:"AC8C/Z"}),icon:t.jsx(T,{}),content:b},{name:"stock-items",label:o._({id:"Jbck4N"}),icon:t.jsx(A,{}),content:t.jsx(U,{params:{location:a}})},{name:"sublocations",label:o._({id:"1eBWAw"}),icon:t.jsx(F,{}),content:t.jsx(Y,{parentId:a})}],[e,a]),p=i.useMemo(()=>[{name:o._({id:"blbbPS"}),url:"/stock"},...(e.path??[]).map(c=>({name:c.name,url:`/stock/location/${c.pk}`}))],[e]);return t.jsx(t.Fragment,{children:t.jsxs(M,{children:[t.jsx(P,{visible:l.isFetching}),t.jsx(v,{opened:r,onClose:()=>m(!1),selectedLocation:e==null?void 0:e.pk}),t.jsx(L,{title:o._({id:"Jbck4N"}),detail:t.jsx(h,{children:e.name??"Top level"}),breadcrumbs:p,breadcrumbAction:()=>{m(!0)}}),t.jsx(R,{pageKey:"stocklocation",panels:k})]})})}export{je as default};
