import{j as e,S as j,G as h,T as L,h as n,A as T,dx as b,aL as k,ap as P,r as m,E as M,o as S,c6 as z,b5 as E,O as f,i as d,R as F,dy as y}from"./vendor-580d7f6a.js";import{L as R}from"./DesktopAppView-f36ad07f.js";import{T as U}from"./BaseContext-71d55e61.js";import{g as C,i as G,p as v,c as I,b as A,r as w,s as B}from"./index-539d0685.js";import{c as D}from"./ApiForm-173d0ec5.js";function J({title:c,shorthand:r,subtitle:l,switch_condition:s=!0,switch_text:o,switch_link:i}){return e.jsxs(j,{spacing:"0",ml:"sm",children:[e.jsxs(h,{children:[e.jsx(L,{order:3,children:c}),r&&e.jsxs(n,{c:"dimmed",children:["(",r,")"]})]}),e.jsxs(h,{children:[e.jsx(n,{c:"dimmed",children:l}),o&&i&&s&&e.jsxs(T,{component:R,to:i,children:[e.jsx(b,{size:14}),o]})]})]})}function H({settingsState:c,setting:r,onChange:l}){function s(a){C.patch(G(c.endpoint,r.key,c.pathParams),{value:a}).then(()=>{f({title:d._({id:"C3htzi"}),message:d._({id:"FImCSc",values:{0:r==null?void 0:r.name}}),color:"green"}),c.fetchSettings(),l==null||l()}).catch(u=>{f({title:d._({id:"CsUgn+"}),message:u.message,color:"red"})})}function o(){var u;const a={value:(r==null?void 0:r.value)??"",field_type:(r==null?void 0:r.type)??"string",label:r==null?void 0:r.name,description:r==null?void 0:r.description};a.field_type===v.Model&&r.api_url&&r.model_name?(a.api_url=r.api_url,a.model=r.model_name.split(".")[1]):((u=r.choices)==null?void 0:u.length)>0&&(a.field_type=v.Choice,a.choices=(r==null?void 0:r.choices)||[]),D({url:c.endpoint,pk:r.key,pathParams:c.pathParams,method:"PATCH",title:d._({id:"mjN1LS"}),ignorePermissionCheck:!0,fields:{value:a},onFormSuccess(){f({title:d._({id:"C3htzi"}),message:d._({id:"FImCSc",values:{0:r==null?void 0:r.name}}),color:"green"}),c.fetchSettings(),l==null||l()}})}const i=m.useMemo(()=>{var u;let a=r.value;if(r!=null&&r.choices&&((u=r==null?void 0:r.choices)==null?void 0:u.length)>0){const p=r.choices.find(_=>_.value==r.value);a=(p==null?void 0:p.display_name)||r.value}return r!=null&&r.units&&(a=`${a} ${r.units}`),a},[r]);switch((r==null?void 0:r.type)||"string"){case"boolean":return e.jsx(E,{size:"sm",radius:"lg",checked:r.value.toLowerCase()=="true",onChange:a=>s(a.currentTarget.checked),style:{paddingRight:"20px"}});default:return i?e.jsxs(h,{spacing:"xs",position:"right",children:[e.jsx(M,{}),e.jsx(S,{variant:"subtle",onClick:o,children:i})]}):e.jsx(S,{variant:"subtle",onClick:o,children:e.jsx(z,{})})}}function N({settingsState:c,setting:r,shaded:l,onChange:s}){const o=k(),i={paddingLeft:"8px"};return l&&(i.backgroundColor=o.colorScheme==="light"?o.colors.gray[1]:o.colors.gray[9]),e.jsx(P,{style:i,children:e.jsxs(h,{position:"apart",p:"3",children:[e.jsxs(j,{spacing:"2",p:"4px",children:[e.jsxs(n,{children:[r.name,r.required?" *":""]}),e.jsx(n,{size:"xs",children:r.description})]}),e.jsx(H,{settingsState:c,setting:r,onChange:s})]})})}function x({settingsState:c,keys:r,onChange:l}){m.useEffect(()=>{c.fetchSettings()},[]);const s=m.useMemo(()=>{var o;return(o=c==null?void 0:c.settings)==null?void 0:o.map(i=>i.key)},[c==null?void 0:c.settings]);return e.jsx(e.Fragment,{children:e.jsxs(j,{spacing:"xs",children:[(r||s).map((o,i)=>{var u;const a=(u=c==null?void 0:c.settings)==null?void 0:u.find(p=>p.key===o);return e.jsx(F.Fragment,{children:a?e.jsx(N,{settingsState:c,setting:a,shaded:i%2===0,onChange:l}):e.jsxs(n,{size:"sm",italic:!0,color:"red",children:["Setting ",o," not found"]})},o)}),(r||s).length===0&&e.jsx(n,{italic:!0,children:e.jsx(U,{id:"3CUVvD"})})]})})}function Q({keys:c}){const r=I();return e.jsx(x,{settingsState:r,keys:c})}function W({keys:c}){const r=A();return e.jsx(x,{settingsState:r,keys:c})}function X({pluginPk:c}){const r=m.useRef(w({plugin:c})).current,l=y(r);return e.jsx(x,{settingsState:l})}function Y({machinePk:c,configType:r,onChange:l}){const s=m.useRef(B({machine:c,configType:r})).current,o=y(s);return e.jsx(x,{settingsState:o,onChange:l})}export{W as G,Y as M,X as P,J as S,Q as U};
