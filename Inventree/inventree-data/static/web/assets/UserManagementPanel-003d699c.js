import{r as l,i as t,j as e,m as F,h as f,S as b,T as _,G as S,af as R,ay as y,e1 as C,D as B,A as N}from"./vendor-580d7f6a.js";import{T as n}from"./BaseContext-71d55e61.js";import{u as A,L as w}from"./DesktopAppView-f36ad07f.js";import{G as O}from"./SettingList-5fd10bc0.js";import{A as T}from"./AddItemButton-9bde5586.js";import{E,b as P,o as z}from"./ApiForm-173d0ec5.js";import{P as Q}from"./Placeholder-f60056df.js";import{D as G}from"./DetailDrawer-7bb74add.js";import{A as u,i as D,a as W}from"./index-539d0685.js";import{b as $,a as Y}from"./UseForm-5e9a21d6.js";import{u as I}from"./UseInstance-05463349.js";import{u as U,R as v,a as L,I as M}from"./InvenTreeTable-7dffc519.js";import{B as g}from"./ColumnRenderers-c7f5177c.js";import"./notifications-b554622d.js";import"./Instance-4f17d9b0.js";import"./StylishText-5ee5b946.js";import"./ProgressBar-f667695e.js";import"./YesNoButton-cd4c504e.js";function q({id:r,refreshTable:p}){var a;const{refreshInstance:o,instanceQuery:{isFetching:d,error:c}}=I({endpoint:u.group_list,pk:r,throwError:!0});return d?e.jsx(F,{visible:!0}):c?e.jsx(f,{children:((a=c==null?void 0:c.response)==null?void 0:a.status)===404?e.jsx(n,{id:"yO7e9w",values:{id:r}}):e.jsx(n,{id:"rubZxD"})}):e.jsxs(b,{children:[e.jsx(E,{props:{url:u.group_list,pk:r,fields:{name:{}},onFormSuccess:()=>{p(),o()}},id:`group-detail-drawer-${r}`}),e.jsx(_,{order:5,children:e.jsx(n,{id:"B7dQAo"})}),e.jsx(S,{children:e.jsx(Q,{})})]})}function X(){const r=U("groups"),p=A(),o=l.useCallback(i=>p(`group-${i}/`),[]),d=l.useMemo(()=>[{accessor:"name",sortable:!0,title:t._({id:"6YtxFj"})}],[]),c=l.useCallback(i=>[v({onClick:()=>o(i.pk)}),L({onClick:()=>{m(i.pk),s.open()}})],[]),[a,m]=l.useState(-1),s=$({url:u.group_list,pk:a,title:t._({id:"k/RLDM"}),successMessage:t._({id:"qYB1E/"}),onFormSuccess:r.refreshTable,preFormWarning:t._({id:"X8Qpil"})}),x=Y({url:u.group_list,title:t._({id:"bm8pgG"}),fields:{name:{}},onFormSuccess:r.refreshTable}),h=l.useMemo(()=>{let i=[];return i.push(e.jsx(T,{onClick:()=>x.open(),tooltip:t._({id:"bm8pgG"})},"add-group")),i},[]);return e.jsxs(e.Fragment,{children:[x.modal,s.modal,e.jsx(G,{title:t._({id:"46SUtl"}),renderContent:i=>!i||!i.startsWith("group-")?!1:e.jsx(q,{id:i.replace("group-",""),refreshTable:r.refreshTable})}),e.jsx(M,{url:D(u.group_list),tableState:r,columns:d,props:{rowActions:c,tableActions:h,onRowClick:i=>o(i.pk)}})]})}function Z({id:r,refreshTable:p}){var x,h,i;const{instance:o,refreshInstance:d,instanceQuery:{isFetching:c,error:a}}=I({endpoint:u.user_list,pk:r,throwError:!0}),m=W(j=>{var k;return(k=j.user)==null?void 0:k.pk}),s=l.useMemo(()=>m===parseInt(r,10),[m,r]);return c?e.jsx(F,{visible:!0}):a?e.jsx(f,{children:((x=a==null?void 0:a.response)==null?void 0:x.status)===404?e.jsx(n,{id:"z0pfhl",values:{id:r}}):e.jsx(n,{id:"h/t9U9"})}):e.jsxs(b,{children:[e.jsx(E,{props:{url:u.user_list,pk:r,fields:{username:{},first_name:{},last_name:{},email:{},is_active:{label:t._({id:"bhnh17"}),description:t._({id:"xYgjoW"}),disabled:s},is_staff:{label:t._({id:"F5kfLm"}),description:t._({id:"paSmTV"}),disabled:s},is_superuser:{label:t._({id:"tIIrDc"}),description:t._({id:"dNitd2"}),disabled:s}},postFormContent:s?e.jsx(R,{title:e.jsx(n,{id:"CE+M2e"}),color:"blue",icon:e.jsx(y,{}),children:e.jsx(n,{id:"bDFcjC"})}):void 0,onFormSuccess:()=>{p(),d()}},id:`user-detail-drawer-${r}`}),e.jsx(_,{order:5,children:e.jsx(n,{id:"zhrjek"})}),e.jsx(f,{ml:"md",children:o!=null&&o.groups&&((h=o==null?void 0:o.groups)==null?void 0:h.length)>0?e.jsx(C,{children:(i=o==null?void 0:o.groups)==null?void 0:i.map(j=>e.jsx(C.Item,{children:e.jsx(w,{to:`../group-${j.pk}`,children:j.name})},j.pk))}):e.jsx(n,{id:"n7RDzR"})})]})}function J(){const r=U("users"),p=A(),o=l.useCallback(s=>p(`user-${s}/`),[]),d=l.useMemo(()=>[{accessor:"email",sortable:!0},{accessor:"username",sortable:!0,switchable:!1},{accessor:"first_name",sortable:!0},{accessor:"last_name",sortable:!0},{accessor:"groups",sortable:!0,switchable:!0,render:s=>s.groups.length},g({accessor:"is_staff"}),g({accessor:"is_superuser"}),g({accessor:"is_active"})],[]),c=l.useCallback(s=>[v({onClick:()=>o(s.pk)}),L({onClick:()=>{P({url:u.user_list,pk:s.pk,title:t._({id:"E33LRn"}),successMessage:t._({id:"Z1AUmg"}),onFormSuccess:r.refreshTable,preFormWarning:t._({id:"af4xhp"})})}})],[]),a=l.useCallback(()=>{z({url:u.user_list,title:t._({id:"UbwSmF"}),fields:{username:{},email:{},first_name:{},last_name:{}},onFormSuccess:r.refreshTable,successMessage:t._({id:"e7XEqK"})})},[]),m=l.useMemo(()=>{let s=[];return s.push(e.jsx(T,{onClick:a,tooltip:t._({id:"UbwSmF"})},"add-user")),s},[]);return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:t._({id:"poTr35"}),renderContent:s=>!s||!s.startsWith("user-")?!1:e.jsx(Z,{id:s.replace("user-",""),refreshTable:r.refreshTable})}),e.jsx(M,{url:D(u.user_list),tableState:r,columns:d,props:{rowActions:c,tableActions:m,onRowClick:s=>o(s.pk)}})]})}function je(){return e.jsxs(b,{spacing:"xs",children:[e.jsx(_,{order:5,children:e.jsx(n,{id:"Sxm8rQ"})}),e.jsx(J,{}),e.jsx(_,{order:5,children:e.jsx(n,{id:"zhrjek"})}),e.jsx(X,{}),e.jsx(B,{}),e.jsxs(b,{spacing:0,children:[e.jsx(f,{children:e.jsx(n,{id:"Tz0i8g"})}),e.jsxs(S,{children:[e.jsx(f,{c:"dimmed",children:e.jsx(n,{id:"L83fOm"})}),e.jsx(N,{component:w,to:"/settings/system",children:e.jsx(n,{id:"D4SseJ"})})]})]}),e.jsx(O,{keys:["LOGIN_ENABLE_REG","SIGNUP_GROUP","LOGIN_ENABLE_SSO_REG"]})]})}export{je as default};
